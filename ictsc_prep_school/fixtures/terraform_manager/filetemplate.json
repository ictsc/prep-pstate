[{"model": "terraform_manager.filetemplate", "pk": 1, "fields": {"name": "VNC\u30b5\u30fc\u30d0\u521d\u671f\u5316\u7528", "file_name": "start.sh", "body": "## Change the password for ubuntu user\r\necho \"ubuntu:@@VNC_SERVER_PASSWORD@@\" | chpasswd\r\n\r\n## disable fail2ban & network-manager\r\nservice fail2ban stop\r\nchkconfig fail2ban off\r\nservice network-manager stop\r\nchkconfig network-manager off\r\n\r\n## Interface setting\r\necho auto eth1 >> /etc/network/interfaces\r\necho iface eth1 inet static >> /etc/network/interfaces\r\necho address 192.168.0.254 >> /etc/network/interfaces\r\necho netmask 255.255.255.0 >> /etc/network/interfaces\r\n\r\n## VNC server settings\r\necho @@VNC_SERVER_PASSWORD@@ | vncpasswd -f > \"/home/ubuntu/.vnc/passwd\"\r\nchmod 700 /home/ubuntu/.vnc/passwd\r\nchown ubuntu:ubuntu /home/ubuntu/.vnc/passwd\r\n\r\nsystemctl daemon-reload\r\nsystemctl start vncserver@\\:1.service\r\nsystemctl enable vncserver@\\:1.service\r\n\r\n## NAPT\r\niptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\r\niptables -A FORWARD -i eth1 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT\r\niptables -A FORWARD -i eth1 -o eth0 -j ACCEPT\r\n\r\n## NAPT permanent\r\niptables-save > iptables.dat\r\necho 'iptables-restore < /root/iptables.dat' >> /etc/rc.local\r\n\r\nservice networking restart", "created_at": "2019-08-05T11:05:42.252Z", "updated_at": "2019-08-05T11:05:42.252Z"}}]